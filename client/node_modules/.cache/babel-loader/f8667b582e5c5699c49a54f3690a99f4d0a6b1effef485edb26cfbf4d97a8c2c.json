{"ast":null,"code":"import _objectSpread from\"C:/Users/RK/Downloads/opentalk_voice_app/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import socket from'../socket';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Connect(_ref){let{user,token,setPage,setRoomInfo}=_ref;const[status,setStatus]=useState('idle');const[partner,setPartner]=useState(null);const[roomId,setRoomId]=useState(null);useEffect(()=>{socket.emit('iamonline',{userId:user.id});const onWaiting=()=>setStatus('waiting');const onMatched=_ref2=>{let{roomId,partner}=_ref2;setStatus('matched');setPartner(partner);setRoomId(roomId);setRoomInfo({roomId,partner});// ✅ Jaise hi partner mile, directly Call page par bhej do\nsetTimeout(()=>setPage('call'),500);};socket.on('waiting',onWaiting);socket.on('matched',onMatched);return()=>{socket.off('waiting',onWaiting);socket.off('matched',onMatched);};},[]);const start=()=>{setStatus('searching');socket.emit('findPartner',{userId:user.id});};const stop=()=>{if(roomId)socket.emit('leave',{userId:user.id,roomId});setStatus('idle');setPartner(null);setRoomId(null);};// ✅ Agar component mount hote hi auto-start chahiye\nuseEffect(()=>{if(status==='idle'){start();// automatically search start kare\n}},[status]);return/*#__PURE__*/_jsxs(\"div\",{style:styles.container,children:[/*#__PURE__*/_jsx(\"h2\",{style:styles.title,children:\"Connect\"}),/*#__PURE__*/_jsxs(\"p\",{style:styles.status,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),\" \",status]}),(status==='waiting'||status==='searching')&&/*#__PURE__*/_jsx(\"button\",{style:_objectSpread(_objectSpread({},styles.button),{},{backgroundColor:'#dc3545'}),onClick:stop,children:\"Cancel\"}),status==='matched'&&partner&&/*#__PURE__*/_jsxs(\"div\",{style:styles.matchedBox,children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Connected with \",partner.username]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Room ID: \",roomId]}),/*#__PURE__*/_jsx(\"p\",{children:\"Redirecting to Call...\"})]})]});}const styles={container:{maxWidth:500,margin:'50px auto',padding:20,borderRadius:10,boxShadow:'0 4px 15px rgba(0,0,0,0.1)',backgroundColor:'#fff',display:'flex',flexDirection:'column',alignItems:'center'},title:{color:'#007BFF',fontSize:28,marginBottom:20},status:{fontSize:16,marginBottom:20},button:{padding:'10px 20px',margin:'10px 0',borderRadius:6,border:'none',backgroundColor:'#007BFF',color:'#fff',fontSize:16,cursor:'pointer',transition:'0.2s'},matchedBox:{marginTop:20,textAlign:'center',width:'100%',border:'1px solid #ddd',padding:15,borderRadius:8,backgroundColor:'#f8f9fa'}};","map":{"version":3,"names":["React","useEffect","useState","socket","jsx","_jsx","jsxs","_jsxs","Connect","_ref","user","token","setPage","setRoomInfo","status","setStatus","partner","setPartner","roomId","setRoomId","emit","userId","id","onWaiting","onMatched","_ref2","setTimeout","on","off","start","stop","style","styles","container","children","title","_objectSpread","button","backgroundColor","onClick","matchedBox","username","maxWidth","margin","padding","borderRadius","boxShadow","display","flexDirection","alignItems","color","fontSize","marginBottom","border","cursor","transition","marginTop","textAlign","width"],"sources":["C:/Users/RK/Downloads/opentalk_voice_app/client/src/pages/Connect.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport socket from '../socket';\n\nexport default function Connect({ user, token, setPage, setRoomInfo }) {\n  const [status, setStatus] = useState('idle');\n  const [partner, setPartner] = useState(null);\n  const [roomId, setRoomId] = useState(null);\n\n  useEffect(() => {\n    socket.emit('iamonline', { userId: user.id });\n\n    const onWaiting = () => setStatus('waiting');\n    const onMatched = ({ roomId, partner }) => {\n      setStatus('matched');\n      setPartner(partner);\n      setRoomId(roomId);\n      setRoomInfo({ roomId, partner });\n\n      // ✅ Jaise hi partner mile, directly Call page par bhej do\n      setTimeout(() => setPage('call'), 500);\n    };\n\n    socket.on('waiting', onWaiting);\n    socket.on('matched', onMatched);\n\n    return () => {\n      socket.off('waiting', onWaiting);\n      socket.off('matched', onMatched);\n    };\n  }, []);\n\n  const start = () => {\n    setStatus('searching');\n    socket.emit('findPartner', { userId: user.id });\n  };\n\n  const stop = () => {\n    if (roomId) socket.emit('leave', { userId: user.id, roomId });\n    setStatus('idle');\n    setPartner(null);\n    setRoomId(null);\n  };\n\n  // ✅ Agar component mount hote hi auto-start chahiye\n  useEffect(() => {\n    if (status === 'idle') {\n      start(); // automatically search start kare\n    }\n  }, [status]);\n\n  return (\n    <div style={styles.container}>\n      <h2 style={styles.title}>Connect</h2>\n      <p style={styles.status}><strong>Status:</strong> {status}</p>\n\n      {(status === 'waiting' || status === 'searching') && (\n        <button style={{ ...styles.button, backgroundColor: '#dc3545' }} onClick={stop}>Cancel</button>\n      )}\n\n      {status === 'matched' && partner && (\n        <div style={styles.matchedBox}>\n          <h3>Connected with {partner.username}</h3>\n          <p>Room ID: {roomId}</p>\n          <p>Redirecting to Call...</p>\n        </div>\n      )}\n    </div>\n  );\n}\n\nconst styles = {\n  container: {\n    maxWidth: 500,\n    margin: '50px auto',\n    padding: 20,\n    borderRadius: 10,\n    boxShadow: '0 4px 15px rgba(0,0,0,0.1)',\n    backgroundColor: '#fff',\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n  },\n  title: {\n    color: '#007BFF',\n    fontSize: 28,\n    marginBottom: 20,\n  },\n  status: {\n    fontSize: 16,\n    marginBottom: 20,\n  },\n  button: {\n    padding: '10px 20px',\n    margin: '10px 0',\n    borderRadius: 6,\n    border: 'none',\n    backgroundColor: '#007BFF',\n    color: '#fff',\n    fontSize: 16,\n    cursor: 'pointer',\n    transition: '0.2s',\n  },\n  matchedBox: {\n    marginTop: 20,\n    textAlign: 'center',\n    width: '100%',\n    border: '1px solid #ddd',\n    padding: 15,\n    borderRadius: 8,\n    backgroundColor: '#f8f9fa',\n  },\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}